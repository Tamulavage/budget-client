<div *ngIf="auth.loggedIn">
    <div *ngIf="auth.userProfile$ | async as profile">
        <div *ngIf="authorizedUsers | async as authorizedUsers else loading">
            <h3>
                Welcome: {{ authorizedUsers.firstName }} {{ authorizedUsers.lastName }}
            </h3>
            <button (click)="toggleAccount()">Account on/off</button>
            <button (click)="toggleBudget()">Budget on/off</button>
            <button (click)="toggleCheckbook()">Checkbook on/off</button>
            <button (click)="toggleGraphs()">Graph on/off</button>
        </div>
        <p></p>

        <div class="table" *ngIf="authorizedUsers | async">
            <div class="row">
                <div class="col account" *ngIf="showAccount && showGraph">
                    <app-accounts [user]="userId"></app-accounts>
                </div>
                <div class="col" *ngIf="showGraph">
                    <app-checkbook-graph [user]="userId"></app-checkbook-graph>
                </div>
            </div>
        </div>        

        <div class="table" *ngIf="authorizedUsers | async">
            <div class="row">
                <div class="col account" *ngIf="showAccount && !showGraph">
                    <app-accounts [user]="userId"></app-accounts>
                </div>
                <div class="col" *ngIf="showCheckbook">
                    <app-tansaction-history [user]="userId"></app-tansaction-history>
                </div>
                <div class="col" *ngIf="authorizedUsers && showBudget &&!showCheckbook">
                    <app-budget-matrix [user]="userId"></app-budget-matrix>
                </div>
            </div>
        </div>

        <div *ngIf="authorizedUsers && showBudget &&showCheckbook">
            <app-budget-matrix [user]="userId"></app-budget-matrix>
        </div>

        <ng-template #loading>
            <div *ngIf="showNewUserWindow">
                <p></p>
                You have been authenticated, but not authorized. Would you like to create a new account for username:
                <b> {{ nickname }} </b>
                <p></p>
                <button (click)="newUserAccount()">Add new Account</button>
            </div>
            <div *ngIf="!showNewUserWindow">
                <p></p> LOADING ...
                <p>This is a known bug, takes approx 1 min to load on initial login</p>
            </div>
        </ng-template>
    </div>
</div>